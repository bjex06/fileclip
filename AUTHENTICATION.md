# ファイルマネージャー認証システム

## 概要

このファイルマネージャーアプリケーションに堅牢で安全な認証システムを実装しました。

## 主要機能

### 🔐 セキュリティ機能
- **パスワードハッシュ化**: SHA-256ベースのハッシュ化でパスワードを安全に保存
- **ログイン試行制限**: 5回の失敗で30分間アカウントロック
- **セッション管理**: JWTトークンベースの認証
- **自動ログアウト**: 30分間の非アクティブでセッション終了
- **パスワード強度チェック**: 大文字、小文字、数字、特殊文字を含む8文字以上

### 👤 ユーザー管理
- **ユーザー登録**: 新規アカウント作成機能
- **パスワードリセット**: 一時パスワード生成
- **パスワード変更**: セキュアなパスワード更新
- **役割ベースアクセス制御**: 管理者と一般ユーザーの権限分離

### 🎯 ユーザーエクスペリエンス
- **レスポンシブデザイン**: モバイル対応
- **リアルタイム検証**: 入力時のパスワード強度表示
- **直感的なUI**: 分かりやすいエラーメッセージ
- **アクセシビリティ**: スクリーンリーダー対応

## デフォルトアカウント

```
管理者アカウント:
Email: admin@example.com
Password: Admin123!

テストユーザー:
Email: test@example.com
Password: Test123!
```

## ファイル構成

```
src/
├── utils/
│   └── auth.ts                 # 認証ユーティリティ関数
├── context/
│   └── AuthContext.tsx         # 認証コンテキスト
├── components/
│   ├── ProtectedRoute.tsx      # ルートガード
│   ├── AccountSettings.tsx     # アカウント設定
│   ├── SecurityManager.tsx     # セキュリティ管理
│   └── Header.tsx              # ヘッダー（更新済み）
├── pages/
│   └── Login.tsx              # ログインページ
└── App.tsx                    # アプリケーションメイン
```

## セキュリティ仕様

### パスワード要件
- 最小8文字
- 大文字を含む
- 小文字を含む
- 数字を含む
- 特殊文字(!@#$%^&*(),.?":{}|<>)を含む

### セッション管理
- JWT形式のトークン
- 24時間の有効期限
- 自動延長機能
- ブラウザタブ間での同期

### セキュリティ対策
- CSRF攻撃対策
- ブルートフォース攻撃防御
- セッションハイジャック対策
- XSS攻撃対策（入力サニタイズ）

## 使用方法

### 基本的なログイン
1. `/login`ページにアクセス
2. メールアドレスまたはユーザー名とパスワードを入力
3. 「ログイン」ボタンをクリック

### 新規アカウント作成
1. ログインページで「こちらから登録」をクリック
2. 必要な情報を入力（メール、名前、パスワード）
3. パスワード要件を満たしていることを確認
4. 「アカウント作成」ボタンをクリック

### パスワードリセット
1. ログインページで「パスワードをお忘れですか？」をクリック
2. メールアドレスを入力
3. 一時パスワードが生成される（実際の環境ではメール送信）

### アカウント設定
1. 右上のSettingsアイコンをクリック
2. 現在のパスワードと新しいパスワードを入力
3. 「パスワードを変更」ボタンをクリック

## 本番環境での改良点

実際の本番環境では以下の改良が推奨されます：

1. **データベース統合**: SQLiteまたはPostgreSQLとの統合
2. **メール送信**: パスワードリセット時の実際のメール送信
3. **ログ記録**: セキュリティイベントのログ記録
4. **レート制限**: API呼び出しのレート制限
5. **2要素認証**: TOTP/SMS認証の追加
6. **暗号化**: 追加のデータ暗号化レイヤー
7. **監査ログ**: ユーザーアクションの詳細ログ

## トラブルシューティング

### よくある問題

**Q: アカウントがロックされました**
A: 5回のログイン失敗後、30分間アカウントがロックされます。時間を置いて再試行してください。

**Q: パスワードが要件を満たしません**
A: 8文字以上で、大文字・小文字・数字・特殊文字をすべて含む必要があります。

**Q: セッションが頻繁に切れます**
A: 30分間操作がないと自動ログアウトします。アクティブに操作を続けてください。

## 開発者向け情報

### AuthContextの使用
```typescript
import { useAuth } from '../context/AuthContext';

const MyComponent = () => {
  const { session, signIn, signOut, loading } = useAuth();
  
  if (loading) return <div>Loading...</div>;
  if (!session) return <div>Not authenticated</div>;
  
  return <div>Welcome, {session.name}!</div>;
};
```

### ProtectedRouteの使用
```typescript
<Route
  path="/admin"
  element={
    <ProtectedRoute requireAdmin>
      <AdminPanel />
    </ProtectedRoute>
  }
/>
```

このドキュメントは認証システムの完全なガイドです。システム開発の参考にしてください。
